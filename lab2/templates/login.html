{% extends 'base.html' %}
{% block content %}
<h2>Login</h2>
<form id="loginForm" method="post" action="/login-vuln" onsubmit="return validateLoginForm(event)">
	{% csrf_token %}
	<label>Login
		<input type="text" name="login" id="login" required minlength="3" maxlength="32" pattern="[A-Za-z0-9_]+">
	</label>
	<label>Password
		<input type="password" name="password" id="password" required minlength="3" maxlength="32" pattern="[A-Za-z0-9_]+">
	</label>
	<div style="display:flex; gap: 8px;">
		<button type="submit">Login (vulnerable)</button>
		<button type="submit" formaction="/login-safe">Login (safe)</button>
	</div>
	<p style="margin-top:8px;">
		<a href="/init">Init/seed database</a>
	</p>
</form>

<hr>
<h3>Raw vulnerable form (no client-side validation)</h3>
<form method="post" action="/login-vuln">
	{% csrf_token %}
	<label>Login
		<input type="text" name="login">
	</label>
	<label>Password
		<input type="text" name="password">
	</label>
	<button type="submit">Submit vulnerable</button>
</form>

<div>
	<h3>Try SQL injection (for vulnerable path)</h3>
	<p>Example username: <code>alice' OR '1'='1</code> and any password</p>
</div>
{% endblock %}
